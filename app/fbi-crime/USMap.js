'use client'

// US State paths for SVG choropleth map
// Simplified paths for performance

const STATE_PATHS = {
  AL: { path: "M628.5,466.5l-2.8-24.6-1.5-15.3-1.1-17.8 1.6-0.2 25.9-2.5 15.7-1.8 0.8,4.1 2.9,17 2.3,12.2 2.1,15.9 0.7,9.7-0.9,8.9-1.5,5.1 4,7.3-3.4,3.8-1.4,5.9-8.9-0.3-0.7,6.2-3.9-3-0.2-3.6-30.1,3.5z", name: "Alabama", abbr: "AL" },
  AK: { path: "M158.1,573.8l-0.3-2 28-61.8 3.9,2.1 3.6-0.5 2.8,2.3 5.9,0.4 1-1.6 5.6-1.2 2.2,2 2.3-1.5 4.9,0.7 3-2.7 1.1,0.8 2.7-2 2,1.4 3.3,0.2 3.6-2.9 4.1,1.4-1.1,2.9 4.1-1.7 1,3 3.1-2.3 1.9,0.3-1,3.7-5.4,6.1 1.3,1.2-2.6,3.5 0.3,1.9-5.6,4.1-8,5.4-1.4,1.8-4.2,1.9-5.2,4.6-2.7-0.2-2,2.5-2.9-0.7-1.7,0.9-0.4,2.9-4.2,2.7-4.1,0.8-0.2,1.2-3.7,2.9-0.9,2.7-2.7,4.9-4,2.2-0.7,3-2.4,1.7-2.9-0.2-2.7-2.7-3.3,0.7-2.5-0.4-2.7-2.7 0.3-1.3-2.4,0.8-2.9,2.9-2.5,1.2-2.7-0.5-1.9,1-3.5-2.9z", name: "Alaska", abbr: "AK" },
  AZ: { path: "M214.9,449.5l-1.6-10.2-3.1-16.6-8.4-48.2-5.8-32.2 19.5-3.4 37.5-6.1 25.2-4.6 19.2-4.2 8.6,40.9 0.2,1.1 6.5,33.3 4.6,21.9-20.7,12.9-2.7,2.4-1.9-0.1-0.9,3.1-4.9,0.8-1.4,0.9-1.6,3-10.5,6.1-0.5,1.9-1.7,0.7-0.1,1.8-10.1,5.9-2.3-0.4-1.6-3.5-21.6,3.4-22.2,4.3z", name: "Arizona", abbr: "AZ" },
  AR: { path: "M580.6,401l-5.9-0.4-38.6,2-24,0.7 0.3-3.9-1.9-6.2-0.4-7.1 3.7-5 0.2-5.7 2.9-4.1 0.2-6.3-3.5-5.5 1.1-4.1 4.4-3.1 1.3-7.5 32.9-0.6 29.9-0.8 5.4,0.1-0.9,6.9 2.9,5.5-1.2,9.1 0.4,3.9 1.5,7.9-0.6,4.6-4.7,6.2 1.1,3.8z", name: "Arkansas", abbr: "AR" },
  CA: { path: "M135.8,396.5l-2.5-11.3-5.6-22.3-2.4-12.3 2.9-0.1 1.1-5.5-0.9-1.7 0.7-3.7-1.4-3.5 1.7-3.1 0.4-7.1-2.2-4.5-0.9-4-1.9-2.9 0.7-3.9-0.7-7.9-2.6-5.7-3.4-5.9 0.5-2.7 3.3-6.1 0.6-4.7-1.9-2.9 0.1-3-2.7-4.9-1.1-5.2 0.2-6.9-2.8-4.6 1.2-0.9-0.1-6.1 1.3-3.9-0.1-0.8 2.4-5.2 0.6-5.4-0.4-3.3 1.2-5.7 0.2-7.2-1.7-3.9 6.6-9.7 2.9-2.5 0.7-3.9 2.5-3 1.5-5.5 2.5-2.9 2-0.2 1.7-2.9 0.7-4.2 2.3-3.5 5.8-8.9 2-1.5 0.6-3.8 9.4-12.8 33.6,8.1 25.3,6.6 25.7,5.9-9.2,40.2 17.9,34.9 4,6.7 14.9,22.3 8.5,10 4.2,16.9 3.9,13.7 0.1,6-0.9,1.9 0.5,5.4 4.4,6.9 0.5,6.9-2.5,6.9-0.3,10.5 4.7,9.7-38.9,7.2-26.6,4.7z", name: "California", abbr: "CA" },
  CO: { path: "M378.5,309.7l-51.6,2.8-57.7,2.9-3.2-41.2-4.1-44.1 50.7-3.9 59.9-5.9 4.5,45.4z", name: "Colorado", abbr: "CO" },
  CT: { path: "M852.3,214.5l-2.4-11.7 1.7-3.6 4.3,0.8 20-4.9 3.7,8.3-0.1,7.6-4.9,4.5-5.5,4.5-4.5-0.9-1.1,2.7-7.9,0.9z", name: "Connecticut", abbr: "CT" },
  DE: { path: "M820.9,275.2l-0.7-3.4-3.9-14.4 9.7-2.5 3,5 2.9,12.5 1.4,8.7-3.5,4.7-3.5,1.5-0.9-3-2.4-0.5-1.5-4.1z", name: "Delaware", abbr: "DE" },
  FL: { path: "M753,538.5l-0.5-3.9-2.5-6.3-2.9-3.4-3.5-5.7-4.9-10.5-4.9-8.1-4.3-9.7-1.4-3.5-5.1-8.5-3.9-4.5 1.2-2.1-0.3-0.3-0.7-3.3 3.5-2.3 5.5-1.1 1.5-1.9 3.6-1.1 1.9,0.5 7.9-3.5 8.3-6.9 2.5-4.2 5.1-3.1 1.1-3 3.5-0.3 8.7,3.5 4,0.1 1.5-2.2-0.9-1.8 4.7-0.7 13.7,2.9 13.9,3.3 10.9,0.7 1.9,4.6-0.5,1.9 5.9,6.5 5.3,6.3 3.9,3.4 3.4,6.9 4.5,6.3 1.5,5.7-0.2,1.9 2.5,6.5 2.9,3.6-0.7,1.8-0.9,5.5 0.6,6.3-1.5,4.3-1.4,5-3.8,3-4.3,7.5-0.2,3.1-4.4,3.9-2.9-0.9-4.7,2.3-3.7,5.1-3.1,1.5-5.3,5.7-4.3,0.3-2.4-3.6-0.5-4.1-3.1-3.2-5.5-4.5-6.3-1.1-3.5,0.3-3.6,3.7-2.9,0.5 0.9-3.5-3.2-4.1z", name: "Florida", abbr: "FL" },
  GA: { path: "M713.8,451.5l-3.9-0.4-19.7,2.2-15.5,1.6-2.9-17-2.1-15.8-2.3-12.2-3-17.2-0.9-4.2 3.7-0.7 12.9-1.8 0.7,1.9 4.4,1.4 3.6,4.3 3.3,2.9 1.7,5.5 4.7,4.5 2.6,0.9 1.5,3.2 4.7,4.3 3.3,3.9 0.8,3.3 3.2,3.4 3.9,2.9 5.9,8.3 4.3,1.8 1.7,3.7 2.5,4.9 4.7,4 3,4.5z", name: "Georgia", abbr: "GA" },
  HI: { path: "M233.1,570.8l1.4-3.5 3.4-0.3 1.1,1.7-3.4,2.8zM243.7,562.7l6.1-3.9 1.8,0.2 1,2.2-2.5,3.2-4.8,0.7zM267.3,559.4l-0.4-2.6-1.5-2.9 0.4-2.6 2-0.1 3.1,2.1 3.9,0.2 0.5,2.6-1.6,2.9-3.2,0.8zM284.1,551.5l3.3-2.9 3.9-1.5 2.2,2.2-0.6,3.2-4.4,1.4-3.9,0.8zM298.7,539.3l1.9-2.7 7.7-0.7 2.1-1.9 2.5,0.4 0.9,3.2-3.9,3.2-6.2,1.5zM325.9,527l9.7-5.3 3.5-0.3 1.2,1.7-2.2,2.9-6.4,3-4.4,1.2z", name: "Hawaii", abbr: "HI" },
  ID: { path: "M197.6,228.9l-6-26.5 1.7-5.1 3.1-2.7 0.1-2.8-2.5-3.1-0.4-2.5 1.7-3.4 2.6-1.9-0.4-4.9-4.5-4.9-1.5-0.7-3.2-5.5-3.4-3.5-0.5-3.6-2.7-1.9 0.9-6.7-0.9-3.7-3.5-1.7-1.1-2.5 0.5-3.8 3.1-7 3.7-3.3 0.6-1.1-1.1-1.9 0.1-2.5-2-2.9 0.5-6.9 2.1-5.4-0.1-3.7 2-0.5 1.7-3.4-0.5-1.2 0.4-3.9 2.7-2.4 4.3,0.4 0.4-1.9 5.8-15.9 1.9,0.7 4.9-1.1 2.1,1.2 6.2-0.4 4.7,1.9 3.9,2.6 3.7-0.3 4.2,0.8 9.9-1.2 5.8,45.7 3.7,26.9 4.9,34.2-24.7,5.2-25.9,4.2z", name: "Idaho", abbr: "ID" },
  IL: { path: "M622.5,311.5l-0.4-3.9 0.9-3.5-0.3-5.6-1.5-2.9-0.2-5.2 1.9-5.6 2.2-3.2 0.5-3.6-0.9-6.7-3.3-5-4.8-3.7-0.4-10.5-0.2-8 0.5-3.9 5.2-4.1 1.7-4.5-0.4-1.5 0.6-3 17.7-1.4 7.9-1.7 3.1,2.7 4.6,0.6 4.2,5.9 9.8,6.8-0.2,4.9-2.8,2.5-0.7,3.9 1.2,3.2-0.6,1.3 0.4,8.1 3.7,6.7 6.2,7.7 5.2,4 0.1,3.9-1.9,5.7 0.8,5.9 1.4,2 0.2,3-2.7,4.2-2.4,4.7-0.2,2.4-3.9,2.2-1.3,4-4.4,3.7-0.9,4.8-5.5,2.6-3.6-2.7-2.9-0.1-2.7-2.6-3.1-1.3-0.9-2.9-4.9,0.7-3.8-1.2-1-2.6-6.9-4.3-1.9,0.1-1.5-6z", name: "Illinois", abbr: "IL" },
  IN: { path: "M660.9,314.1l1-3.9-0.8-3.8-0.2-2.9 3.7-2.7 1.3-2.9-1.1-8.6-0.6-12.6 0.5-20.9 24.2-2 8.8-1.4 0.9,2.7 5.5,6.1 0.5,1.9 3.8,3.9 0.2,3.7 2.9,4.6-0.5,5.2-3.1,4.3 0.2,3.4-0.5,1.1 1.9,3.5-0.2,4.9-2.2,4-3.2,4.6-4.7,3.4-2.5,5.7-3.9,3.3-3.6,3.9-0.7,4.4-26.2,2.8z", name: "Indiana", abbr: "IN" },
  IA: { path: "M565.3,241.4l0.3-5.9-1.5-7.1-2.5-4.2 0.2-3-2.6-5.7-0.7-5.9 0.6-2.1-1.9-4.2 0.2-3.2 58.2-2.7 36.9-0.5 0.3,2.5 1.9,2.7 3.2,2.2-0.2,5.1-2.9,4.9 0.5,3.3 2.6,2.2 2.4,1.4-0.1,5.6-4.1,3.3-1.8,3.9-4.7,0.4-2.5,2.1-4.9-0.7-6.9,1.4-8.4,0.3-10.8,1.2-29,1.5-19,0.6z", name: "Iowa", abbr: "IA" },
  KS: { path: "M506.8,335.9l-72.2,1.4-49,0.2 0.7-30.4-0.8-21.3 44.9-0.7 63.9-2.3 8.9-0.2-0.3,7.9 1.5,6.3 2.9,4.4 2.9,2.7 0.1,3.5z", name: "Kansas", abbr: "KS" },
  KY: { path: "M715.9,352.7l-6,4.6-23.3,3.9-6.7,1.7-1.2-2.6-32.9,4.1-13.3,1.2-6.9,1.3-4.4-0.3-4.9,3.5-7.4-0.9 1.2-3.9 3.5-3.7 0.3-3.1-3-3.2 3.2-5.2 2.9-0.8-0.2-2.4 2.9-5 3.5-3.9 3.2-2.5-0.1-2.7 3.9-2.5 0.5-3.9 1.1-3 25.5-3.2 1.9,2.3 5.6-3.7 2.9-0.5 2.9,1.1 3.9-1.4 4.5,0.3 2-4.9 3.1,0.1 2.3-1.9 11.1-1.2 8.1-1.5 4.2,5.2 5.5,5.7 6.9,3.1 4.7,4 3.9,5.4-0.9,3.4 3.2,2.5 2.7,4.8 3.5,1.2z", name: "Kentucky", abbr: "KY" },
  LA: { path: "M587.6,500.1l-2.7-7.8 0.5-8.7 2.5-3.6-2.5-2.5-0.7-5.5 1.1-7.6 3.1-3.1 0.3-9.8-2.3-2.9-0.1-4.4-1.7-1.5 0.2-1.7 23.5-0.8 24.6-0.4-0.3,7.2 1.1,4 3.1,3.9 0.3,5.8-6.3,4.7 4.2,5.4-1.6,2.9 1.9,2.5-1.4,2.9 1.7,2.4 0.1,1.7-1.1-0.1-2.3-2.7-3.2-0.5-2.5,1.3-3.9-1.1-3.9,1.5 1.9,2.3 0.5,2.4-1.5,2.6 0.2,2.9-0.3,1.7-2.5-2.7-0.9,1.1 1.7,3.1-0.2,2.5-4,0.9-0.7-2.5 0.7-2.9-3.9,1.5-1.9,2.9 0.9,1.9-1.9,1.2-5.2-1.2 4.9-2.5-0.4-1-4.9,2.1-2.1,2.1-5.5-1.5-3.9,2.9 0.5,2.2-2.9-0.2-3.7,2.5z", name: "Louisiana", abbr: "LA" },
  ME: { path: "M900.3,146.7l1.5-1.8 2.5,2.8 0.1,3-2.9-0.2-1.2-3.8zM854.9,150.4l0.2-3.2 2.3-3.7-0.4-4.6 3.5-5.2 2.9-6.9 1.6-4.9-1.9-3.9 0.7-5.4-0.1-9.7 3.6-5.9-0.6-2.9 1.8-6.2-0.7-2.4 1.4-5.5 2.5-6 1.5-3.5-0.4-2.7-2.7-3.5 1.7-5.4 4.2-5.2-0.4-2 0.7-2 3.4-3.5 1.7,0.5-0.4-2.1-2.3-4.7 2-2.9-0.1-5.9 2.2-6.8 3.7-4.9 1.7-5.7-1.2-6.5 2.7-1.2 4.3,3.9 2.9,5.9 0.6,5.5 5,1.9 2.7-1.5 2.3,1.5-2.9,4.1-2.8,0.5 0.7,5.2 0.5,3.9-2.7,3.4-0.7,3.3 0.4,3.4 4.7,2.1-1.2,1.7 2.1,8.8 3.2,7.2 2,5.9 1.5,2.7 2.8,9.5 2.8,2.1 0.2,3.2 2.9,2-0.5,5.5 3.4,2.3-0.4,3.7-3.5,2-6-2.9 1.7,4-1.6,3.7-3.1,2.1-1.7,3.5-3.5-0.1-1.2-5.5-4.4-2.5-2.9-5.1-2.3-0.1-1.2,2.7-6.1-5.9-4.8,5.2z", name: "Maine", abbr: "ME" },
  MD: { path: "M833.5,294.5l-3.8-10.6-5.2-15.7 1.9-0.3 4.8-4.5 3.5-4.2 2.1,0.1 3.7-2.1 4.4-4.5-0.4-2.7 5.9,2.7 5.5-1.5-0.8,3.2-1.9,0.7 0.1,3.2 1.7,3.7-0.5,2.9 4.7,1.1 3.2-0.5 1.5-2.2 1.7-2.2 0.2,9.6-2.2,0.4-3.9-0.2-4.5,2.3-2.3-2.9-2.7,5.4 1.8,3.9-2.1,3.1 1.3,3.7 2.1-0.3 1.2-1.5 0.8,4.3-7.5,2.7-8.7,1.2-8.9-0.5z", name: "Maryland", abbr: "MD" },
  MA: { path: "M893.9,199.1l0.6-2.2 2.7,0.9 1.9-1.2-1.1-2.4-3.5-0.4-4.1,0.9-0.4,3 2.2,1.4zM855.3,203.9l27.3-6.9 2.5-0.5 1.7-3.2 4.8-1.4-0.7-2.7 3.9-0.5 2.1,3.8 0.2,2.8-4.7,1.5 0.1,1.1-2.9-0.3-1.1,1.9 2.2,1.7-5.6,2.1-2.7-4.3-2.5-0.9-4.7,4.7 1.2,4.2 3.2,0.1 5.9-3.6 3.1,3.4-3.9,5.6-3.3-0.2-3.5-2.1-5.5,0.7-10.1-0.5 1.4-5.9z", name: "Massachusetts", abbr: "MA" },
  MI: { path: "M658.5,246.7l2.5-4.2 3.9-3.9 0.8-3.9 3.4-2.7 0.7-2.1 0.4-3.9-0.9-2.4 3.7-1.1 1.8-2.5-0.5-5.6 1.2-2.7 1.2-0.7 0.3-4.9-1.1-0.5-1.1-6.1 3.3,0.3 5.1-5.5 2.9-1.7 3.4-3.7 2.5,0.9 5.9,1.7 3.9,0.8 2.9,2.7-3.1,4.2-2.2,2.9-0.7,3.9 0.5,2.2-0.2,3.4 3.3,2.9 1.3,2.1 0.1,2.5 2.7,4.2 0.3,1.3-1.2,4.4 1.3,3-1.8,0.7-2.6-1.5-4.3,0.9-2.2,1.8-1.6,0.2-6.7,2.9-2.3,2.2-1.2,4-6.9,1-3.9-0.3-0.5,4.7-6.5,2.5-1,3.9zM619.4,177.5l1.5-2.1-0.4-10.9 3.6-6.1 1.2-0.8-1.4-2.9 1.8-2.9 3-0.7 3.7,0.7-0.2,4.7-1.7,3.5 0.4,2.5 1.1,1.5-0.5,3.9 2.5,3.4-0.2,2.9-0.7,0.7 0.6,2.8 1.7,1-0.5,2.7-2.5,1.5-0.7-0.7-2.5,1.9-2.9-0.7-2.6-1-1.5,1.8-4.2-1.9-1.5-2zM651.7,132.9l3.4-3.9 2.5-1.6 4.9-1.2 2.5,0.7 0.5,1.7-3.2,3.9 0.9,0.5 5.8-3.9 2.4-0.3 0.4,0.9-3.9,6.4-3.2,3.2-3.7,2.5-2.7-0.2-3.4-3.9-0.5-2.7z", name: "Michigan", abbr: "MI" },
  MN: { path: "M552.5,191.7l-1.1-6.6-2.2-7.8-1.6-10.5-1.6-5.6 0.6-4.6-1.5-4.4 0.1-6.1-0.1-7.5-1.9-5.6-1.6-11.4 0.7-4.5 2.7,0.1 0.3-2.7 4.7-0.2 0.1-5.3 1.5-0.2-0.1-8.9 52.6,0.1 0.1,10.9 4.2,3.7 6.6,2.9 1.9,0.3 1.7,4.5-2.9,2.9-6,3-3.9,5-1.1,2.9 0.5,8.7-0.1,4.9 4.5,4.5 7.9,3.8-0.2,3.5-3.9,0.2 0.1,2.5 3,1.9-0.9,5.2-0.1,4.4-1.7,0.2-3.4-3.9-3.3-0.6-5.5,2.4-6.7-0.3-1.3,2.5-0.6,6.4-3.2,0.5-3,2.9-6.4,2.7-3.1-0.4-0.8-3.5-5.9,1.4-4.2-0.5-2.7,4.1-3.5,0.2-2.4-3.9z", name: "Minnesota", abbr: "MN" },
  MS: { path: "M623.9,501.9l-35.2,3.5-0.7-4.9 2.7-7.6 0.7-5.3-0.7-1.2 0.5-2.7 0.7-4.9 3.4-4.9 1-6.6-0.5-3.9 0.7-3 5.2-10.5 0.2-5.7 1.1-2.3-0.4-4.5 1.5-7.2-0.9-2.9 1.1-9.1-2.9-5.5 0.9-6.9 38-1 5.3,0.3 2.8,23.9 1.6,15.9 1.6,17.5 0.3,6.5 0.6,6 4,7.1-1.7,5.5 3.8,4.1-0.5,6.4-0.8,5.3z", name: "Mississippi", abbr: "MS" },
  MO: { path: "M618.4,327.2l-3.2,3.5-0.6,2.1-0.5,4.9-2.1,2.2-0.1,4.5-4.7-0.3-30.7,1.5-32.4,0.9-7.9-0.2-1.2-2.2-0.1-3-2.6-2.8-2.7-4.4-5.7-2.3 0.1-1.1-0.8-18.7-0.1-9.2-0.8-20.9 8.7,0.1 26.9-0.8 0.9,2 2.7,2.1 3.5-1.3 2.9,1.3 4.5-2.1 1.5-3.7-0.5-3.7 0.5-2.1 3.2-3.1 2.1,1.1 3.1-0.4 1.4-2.7 0.5-5.8 2.1-2.1 3.6-0.8 3,2.2 5.1,0.6 4.2,5.8 9.6,6.7-0.2,4.9-2.7,2.5-0.7,4.1 1.1,3.2-0.5,1.1 0.5,8.1 3.5,6.3 6.1,7.5 5.1,3.7z", name: "Missouri", abbr: "MO" },
  MT: { path: "M297.2,151.8l-2.7-23.9-4.5-35.9-2.9-21.8 28.5-3.1 29.6-4.5 30.3-5.1 30.7-6.1 27.2-5.5 3.5,17.2 4.3,24.3 2.5,9.7 1.8,9.2 2.4,7.1 3,3.4 0.9,3-1.9,3.4-0.1,3.5 3.3,3.5 1.2,3.4-0.8,4.1-2.1,2.9 0.1,1.6-3.5,6-0.9,3.9-3.1,1.8-2.7,0.5-1.9,1.3-3.7-0.3-4.3,1.5-2.4-0.5-3.4,1.5-4.5-0.4-1.6,1.7-1.9-2.7-0.3-3.7-4.9-2.5-1.8-0.5-4.2,0.9-1.8-1.1-0.3-4-1.9-0.4-3.3-3.6-3.7-0.5-5.1,0.5-1.5-2.5-1.4-5.5-3.9,0.1-2.9-1.5-0.4-3-2.9,0.3-2.7,2.9-0.7,2.7-2.2,3.7-4,2.2-5,1.3-1.4-0.6-0.4-3.9-3.5-2.4-2.4,0.6-3,1.6-3.2-1.1z", name: "Montana", abbr: "MT" },
  NE: { path: "M434.9,255.9l-34.7,1.7-38.9,0.6-24.9,0.1-0.5-9.7-5.6-39.1 38.3-2.2 57.9-4.5 4.9-0.4 1.7,2.1 5.2,0.1 2.7,4.1 3.7,0.7 3.2,2.4 2.5-0.5 4.4,1.6 4,0.6 0.1,3.9 0.4,4.1-1.9,5.8-1.9,4.3 0.4,3.9 3.8,6.9 3.9,5.2 2.7,2.8 0.1,4.3z", name: "Nebraska", abbr: "NE" },
  NV: { path: "M180.9,341.9l-19-96.9 13.9-2.9 23.8-5 24.5-5.3 18.5,91.6-2.6,2.3-3,5.3-0.9,3.2-5.5,6.5-0.8,2.7 0.5,3.9-3.2,0.8-3.9,3.2-3.8,4.5-3.3,3.2-1.2,0.9z", name: "Nevada", abbr: "NV" },
  NH: { path: "M880.4,185.3l-1.6-1.3-3.4,0.5-1.9-7.7-0.5-5.3 2.3-3.6 0.7-5.9-2.4-2.6-0.3-4.2 1.7-6.2 1.5-9.1 0.5-3.3-0.7-2.7-1.8-0.8 0.5-2.3-0.2-3.3-0.7-3.9 1.4-4.6 2.4-5.7 1.7-1.7 0.1-3.9 4.9,2.2 1.7,0.6 0.7,6 5.2,1.2 0.8,3.2-3.3,4.2 0.2,3.6 0.7,3.3-2.7,3.9-0.4,3.6-0.3,3.9 2.5,1.3-0.2,5.7 0.8,9.5-0.4,13.9-2.9,4.6z", name: "New Hampshire", abbr: "NH" },
  NJ: { path: "M840.9,264.4l-1.5,2.6-1.6,1.9-0.5,5.7 1.2,2.5 3,0.2 1.4,4.2 4.9,4-0.4,2.5-0.9,2.7-2.4,2.4-1.4-0.9-1.4-2.6-0.9-0.8-1.5,0.8-1.9-0.2 0.9-2.4-1.8-0.8 1.1-3.5-1.8-2.4-0.3-5.1 1.5-2.7-0.5-1.9-2.2-1.1 0.7-1.9-1.5-2.2 1.5-0.2 2.7-5.1 2.3,0.5 3.5,2.2z", name: "New Jersey", abbr: "NJ" },
  NM: { path: "M309.6,455.6l4.3-51.9 8.9-88.9 18.3,1.8 36.2,3.5 36.2,2.6-4.7,53.9-0.9,4.7-24.6-2.2-0.9,7.5-50.9-4.9-6.3,75.6z", name: "New Mexico", abbr: "NM" },
  NY: { path: "M824.9,205.3l2.2,0.9 5.5-3.3 4.5-1.7 4.7-0.9 4.5,1.5 2.5-0.9-0.2-2.1-1.5-2.9-0.7-3.7 0.4-1.5-3.5-0.7-5.9,3.5-7.4,2.5-13.5,3.5-9.9,1.6-5,0.5-0.7-3.6 1.9-1.3 1.5-3.1-1.7-3.3 2.3-2.5 1.4-2.9-0.6-2.1 3.9-3.9 3.1-1.7 3.7-3.7 4.9-3.3 3.9-1.9 4.4-1.1 7.6-0.5 3.3,1.9-0.1,3.5-3.1,2.5 0.3,1.2 5.3-1.9 6.3-1.2 6.7-0.1 3.5,0.6 3.7,2.3-0.7,2.9 0.7,0.7-0.9,3.7-1.1,0.8-0.1,3.9 3.2,4.7 4.5,7.7-1.4,4.1 0.2,1.5 3.8-3.2 4.3-5.3 2.1-1.9 3.7-1.5 4.7,1.9 4.6,1 12.9-4.6 3.1,1.9 0.7,4.8-3.7,4.5-6.4,6.9-6.2,5.4-4,2.9-5.5,3.3-5.9,5.7-2.7,1.1-3.2,2.7-3.2,0.5-1.9,1.5-4.9-0.1-2.9,1.4-5.9,0.5z", name: "New York", abbr: "NY" },
  NC: { path: "M827.8,375.7l-8.9,3.1-5.6-0.2-8.1,5.1-7.3,6.2-2.7,4.9-1.2,0.2-4.2,4.1-8.2,2.9-4.2-0.5-1.3-1.5 1.3-0.8 0.4-3.3-2.4-3 0.2-1.4-21.2,2.9-26.2,2.4-11.7,0.4 0.3-2.9 4.8-2.6 3.1-0.5 1.9-3.6 5.1-3.1 2.1-3.7-0.5-1.7 3.9-0.9 6-5.7 2.5,0.4 2.9-2.7 3.1-6.1 5.8-4.5 2.5-0.8 0.7-2.3-0.2-2.9 5.5-0.3 28.9-3.7 22.7-3.2 16.9-3.2 1.1,6.5 2.9,7.1 2.9,2.1 3.2,4.1 3.5,2.4z", name: "North Carolina", abbr: "NC" },
  ND: { path: "M445.6,148.5l-0.5-6.8-2.4-8.8-0.4-7.5-1.9-9.2-0.3-5.1-2.5-8.4-0.4-8.4 63.1-1.9 55.7-3.5 1.5,11.5 1.9,5.6 0.1,7.6 0.1,6.1 1.5,4.3-0.6,4.6 1.5,5.5 2.3,10.7 1.1,6.4z", name: "North Dakota", abbr: "ND" },
  OH: { path: "M728.7,304.1l-3.7-2.7-4.5-5.5-4-4.8-6.4-3-3.8,3.4-5.2,0.8 0.5-2.9-1.7-3.7-0.1-3.1 1.9-0.8 0.3-2.5-0.9-3.2 0.9-5.2-3-4.5-0.2-3.3-3.6-3.9-0.6-2.1-5.3-5.9-0.8-2.5-0.6-11.9 24.9-5.5 13.8-3.5 4.9-1.2 11.7-2.7 6.2,5.7 4.1,4.9 3.5,4.2 5.8,6.7 2.3,4.7-3.1,4.3-4.4,4.5-0.9,4.5 1.5,4.3 0.3,4.5-3.7,3.9-1,4.9 2.1,5.5-3.2,4.2-2.1,3.1z", name: "Ohio", abbr: "OH" },
  OK: { path: "M427.9,394.5l-29.7-1.5-1-23.6 42.3,1.2 48.9,0.1-1.3-10.6 0.6-31.9 50.3-0.2 72.1-1.4-0.1,6.7-3.7,5.4-2.1,3-0.8,4.7 2.6,3.2 1.7,2.7 3,1.9 0.7,1.9-4.2,3.1-1.1,4.2 3.5,5.4-0.2,6.4-2.8,4.1-0.2,5.6 1.9,6.2-0.3,4.1-49.1,0.6-49.7-0.8-28.5-0.8-48.4,0z", name: "Oklahoma", abbr: "OK" },
  OR: { path: "M128.3,231.6l-4.5-1.4-8.7-4.8-3.9-1.6-5.5-1.9-4.7-3.5-4.1-1.4-6.6-4.1-8.9-7.5 1.5-7.4 0.9-7.5-2.3-5.5 0.3-6.4-1.9-6.6-0.4-10.1 0.8-8.8-0.9-7.9 6.9-0.4 8.5-3.9 6.5-1 3-2.6 6.2-2.1 2.8,0.4 5.6,2.9 5.3,0.5 5.7-1.2 25.7,6.9 28.7,6.7 24.7,5.2-6.5,31.7-9.3,41.5z", name: "Oregon", abbr: "OR" },
  PA: { path: "M826.5,256.5l-4.7,4.8-2.7,0.4-3.5-3.2-2.2-0.5-2.5,4.4 0.5,1.8 2.1,0.7 1.1,3.7-4.7,4.5-1.9,0.3-60.2,11.3-11.1,1.6 0.8-3.9 3.9-2.9 1.4-2.1 2-5.6-0.1-2.9-2.5-2.8-1.2-4.3 2-4.9 2.7-6.5 2.3-3.2 2-2.1 2.1,0.5 5.3-2.9 5.7-0.9 5.9-1.5 4.3,0.1 1.9-1.9 17.3-3.3 32.4-6.6 4.4,21.4z", name: "Pennsylvania", abbr: "PA" },
  RI: { path: "M877.6,215.2l-0.7-5.9-1.9-7.3 7-2.1 1.9,3.5 3.9,4.5-0.5,3.2-2.4,0.1-2.1,4.9z", name: "Rhode Island", abbr: "RI" },
  SC: { path: "M767.7,423.9l-4.3-2.7-5.3-4.7-4.1-5.2 0.6-2.9-4.4-10.6-4.9-3.9 2.7-4.9 4.2-5.2 8.3-4.8 0.2,2.5 7.9-4.4 5.5-1.1 7.9-4.1 7.5-4.1 3.9-1.5 0.1,5.1 4.6,1.5 2.3,2.4-1.3,5.9 4.6,2.9 3,4.8-2.6,4.2 3.5,2.1 2.3,4.6-1.7,1.5-4.2-0.3-0.5,4.2-2.5,3.2-4.3,1.3-3.1,2.3-3.1,6.5-3.8,1.2-3.1,3.9-5.7,4.9z", name: "South Carolina", abbr: "SC" },
  SD: { path: "M445.3,221.2l-53-0.2-46.3-1.4-0.4-4.2 0.7-8.4-1.5-5-0.2-7.7 2.5-4.8-0.2-5.9 0.7-5.7-0.2-7.9-0.4-7.5 1.2-4.1 0.1-9.7 0.4-0.3 119.5-5.1 0.5,6.8-0.1,5.9 1.2,6.5-0.2,3-1.9,4.3 0.2,2.8 3.2,4.6 0.9,2.7-0.1,2.6-4.6,2.2-3.6,4.5-0.1,5.7-2.9,3.1-0.7,2.5 0.5,3.9-1.5,3.8-4.6,2-2.7-0.1-2.9-2-3.4,1.3-2.5-2z", name: "South Dakota", abbr: "SD" },
  TN: { path: "M715.1,372l-4.2,4-40.9,4-18.7,1.8-17.9,1.2-14.9,0.6 0.5-4.9-3-0.3-2.5-3.6-4.2-0.2-1.6,2.2-3.6,1.7-3.9-4.2 1.1-5.5-4.7,0.7-0.9-4.5 0.9-4.5-1.4-3.7 6.1-0.4 4.9-3.5 4.4,0.3 7-1.3 12.9-1.2 33.3-4.1 1.2,2.6 6.4-1.6 23.3-4 6.4-4.6 2.9,4.7 4.9,0.6 2.9,5 5.5-0.2 2.9,4.9 2.9,3.4-0.4,4.5-2.6,3.1z", name: "Tennessee", abbr: "TN" },
  TX: { path: "M427.9,538.5l-10.9-64.5-5-32.9-5.9-33.1-2.7-12.9 28.4,1.4 31.7,0.9 0.7,23.4 49.6-0.1 49.5,0.8 28.9,0.8-0.4,8.8 1.5,7.2 0.4,4.5-1.1,2.3-0.2,5.6-5.1,10.5-0.8,3.1 0.6,4.1-0.9,6.5-3.6,5-0.6,4.8 1.8,6.2 2.7,7.7 0.7,4.8-0.2,2.3 2.9,5.8 1.5,3.4 1.9,1.4 1.5,3.5 3.1,2.5 2.5,3.6 4.1,1.6 1.3,0.9 5.9,0.9 3.2,2.9 4.5,0.7 3.9,4.4 3.9-0.9 4.7,1.5 5.2-2.5 2.5-0.9 3,0.6 4.7-1.2 2.3-4.5 1.6-4.3 2.2-1.9-0.3-2.7 0.4-4.7 1.1-2.9 3.9-5.2 0.7-3.1-2.1-1.5 0.4-4.9 4.3-6.1-0.2-1.9-0.9-2.7 1.2-2.5 1.8-2.2 2.9-0.1 2.3,0.5 3.2-0.4 2.7,3.5 3.2,2.1 1.5,3.5 1.1,2.9-0.4,4.6-0.5,3.5 0.7,3.3 2.4,2.2 3.5,2.5 3.3,3.4-0.3,2.9-1.8,4.9-4.7,7.9-1.5,3.3 0.5,1.9-0.3,4.4 3.9,4.7-0.4,2-1.7,4.9-1.6,2-1.2,5-5.8,0.6-8.9,2.7-2.9,2.1-4.7,0.5-6.6,4.5-4.9,0.5-2.5,1.7-8.5,2.7-7.9,0.1-3.3,1.2-5.9-3.2-4.2,0.8-2.2-0.8-3.1-4-4.5-0.5-3.7,2.4-5.9-2.8-5.9-0.1-2.7-1.7-8.3-6.7-3.2-0.3-0.5,0.9-5.4-3.6-1.1-2.6-4.2-1.8-3.2-4.2-5.2-0.9-3.6-2.9-0.7-5.3-3.6-6.6-1.9-8.7-1.8-2.9-0.5-5-4.5-5.5-0.5-3.5-2.7-4.9-1.4-6.6-0.4-2.5-4.9-4.9-2.7-2.9-6.5-2.8z", name: "Texas", abbr: "TX" },
  UT: { path: "M265.8,330.1l-50.1,5.8-1.3-9.9-4.3-33.5-8-52 25.3-4.4 24.9-4.5 19.5-3.5 6,26.6 10.7,49.9 1.9,9.2z", name: "Utah", abbr: "UT" },
  VT: { path: "M856.5,181.1l-2.3-1.3-0.9-3.9-2.3-0.5-2.1-5.4 1.4-4.5 0.2-3.3-1.5-6.9-4.3-4.3-0.9-5.5 0.8-3 1.4-4 0.9-3.5-0.1-3.7 21.9-5.3 0.4,3.3-0.4,3.2-1.6,9.1-1.7,6.3 0.3,4.1 2.4,2.5-0.7,5.9-2.3,3.7 0.5,5.1 1.9,7.8 3.4-0.5 1.4,1.1-5.9,0.8-3.2,2.6z", name: "Vermont", abbr: "VT" },
  VA: { path: "M832.5,315.2l-5.2,6-4.3,1.7-2.1,3.3-2.3,1.9-2.1-1.3-3.9,1.2-0.6,4.6 3.6,3.9 0.1,4.1-1.7,4.1-8.4,3.8-3.4-0.9-2.7,3.7-3.6-1.5-4.3,4.3-3.9,0.6-3-1.5-3.5,2.4-3.7-0.6-2.2-2.7-4.2-0.9-1.1,2.6-6,4.4-28.6,3.8-22.4,2.9 0.1-2.7 0.4-3.7 3.9-1.9 1.3-3.8 2.9-1.2 4.7,1.3 2.3-4.9 4.4-0.9 1.5-4.9 4.5-3.9 0.3-3.6 0.7-1.6 6.5-2.5 2.5,0.6 3.5-2.5 4.9,3.2 4.1,0.3 3.4-3.4 1.5,0.9 2.5-2.8-0.7-1.3 1.4-2.2-0.7-1.9 1.5-0.4 3.1,1.8 5.6-4.7-0.2-1.5 5-3.8 3.7,1.4 2.7-3.7 7.1,3.5-0.2,1.7 4.5,2.5 4.7-6.5 3.7,0.7 1.1-1.8 8.9-0.5 9.1,4.7z", name: "Virginia", abbr: "VA" },
  WA: { path: "M170.9,97.8l-3.5-0.9-2.7-2.3-0.9,0.8-0.7-2.7-2.9,0.6-1.3-1.5-0.9-3-2.1-0.4-0.5-3.3-4.3-0.2-2.1-3.3-1.7-5.9-3.1-1.5-0.5-2.1-3.5-0.9-4.3-3.9-6.1-1.9-1.7-0.9-1.1-2.9-3.8-1.2-0.4-3.5-4.1-3.3 4.9-0.5 0-4.6-3.4-0.1-1.5,1.8-0.5-2.7 3.1-0.4 3.7,1 3.7-2.5-0.5-3.9-1.9-1.6 1.2-4.1-0.9-3.2 0.9-3.6 2.9-0.1 2.1-4 0.5,0.9 0.1,5.2 2.5,2.8 4.5,1.5-2,2.3 2.4,3 2.7,0.3 1.5,2.9 4.4,1.6 0.1-2.2-3.4-5-0.4-4.2 3.9-0.2 4.1-0.4 7.3,2.1 5.5,1.5 6.1,1.1 25.9,6 28.3,5.5-6.5,31.9z", name: "Washington", abbr: "WA" },
  WV: { path: "M768.1,311.2l-2.5,2.7-0.4,4.1-2.9,3.7-1.8-0.6-1.7-2.2-2.6,2.3-0.3,3.9-3.7,3.2-3.2-0.1-4.7-3.9-3.5,1.4-2.9-0.9-2.8,0.6-5.5,3.5-1.9-2.5-1-3.8-4.1-0.3-0.9,4.3-2.1,2.5-0.7,5.2-2.4-0.4-3.5,3.7-1.3,3.9-0.9-2.7-3.6-2.9 4.4-3.9 2.6-5.5 3.5-3.9 3.7-2.1-0.3-2.3-3.8-3.7 0.3-3.5 3.1-4.3 0.5-5.2-2.9-4.6-0.2-3.7-3.8-3.8-0.5-1.9-5.3-6 12.9-3.2 4.7,4.7 3.1,4.3 3.7,2.7 6.4,2.9 4.5,5.6 3.9,2.7-0.5,2.8 5.3-1 3.7-3.5z", name: "West Virginia", abbr: "WV" },
  WI: { path: "M603.1,214.9l-3.5-2.2-2.7-3.5-2.5-8.2-2.3-4-4.3-4.5-1.4-3.9-0.2-5.6 2.3-4.9 1.3-5.9-0.1-3.6-1.3-1.3 0.8-2.5 1.1-4.2-1.1-3.5-0.9-5.8 0.9-3.9 0.9-4.5-0.5-5.9-1.9-2.9 0.2-2.5 2.5-3.2 1.9,0.5 0.5-4.9-2.7-1.5-0.1-2.1 0.9-2.7 2.1-3.7 0.6-3.5 0.3-4.4 3.9-0.2-0.2-3.5 3.9,0.6 4.7,0.7 0.9,3.7 3.7,2.2 1.1,1.2 4.6-0.2 1.7-2.8-1-3.9 0.8-3.2 2.9-1 1.7-1.3 1.9,0.9 5.5-1.2 7.2,3.5 5.9,2.9 3.8,2.9 5.4,3.7 1.1-1.5 3.6,2 3,4.6-0.2,3.9-0.9,0.9 0.2,3.5-1.4,4.9-0.6,4.4-2.4,0.9 0.4,4.6-0.6,6.3 0.6,3.7 3.7,4.2 1.3,3.3-1.3,3.9 1.7,2.8-0.2,4.2-0.7,2.6-7.6,1.7-18,1.5-0.7,3.2 0.5,1.1z", name: "Wisconsin", abbr: "WI" },
  WY: { path: "M326.6,223.5l-2.5-23.6-5.4-50.3 47.9-5.2 56.9-8.1 4.1,44.1 3.3,41.3-56,3.5z", name: "Wyoming", abbr: "WY" }
}

export default function USMap({ data, metric, year, onStateClick, selectedState }) {
  const [hoveredState, setHoveredState] = useState(null)
  const [mousePos, setMousePos] = useState({ x: 0, y: 0 })

  // Build lookup for state data
  const stateDataMap = {}
  if (data && Array.isArray(data)) {
    for (const row of data) {
      if (row.year === year) {
        stateDataMap[row.state] = row
      }
    }
  }

  // Calculate color scale
  const values = Object.values(stateDataMap).map(d => {
    if (!d || !d.pop || d.pop === 0) return 0
    return (d[metric] || 0) / d.pop * 100000
  }).filter(v => v > 0)

  const minVal = values.length > 0 ? Math.min(...values) : 0
  const maxVal = values.length > 0 ? Math.max(...values) : 1

  const getColor = (stateAbbr) => {
    const d = stateDataMap[stateAbbr]
    if (!d || !d.pop || d.pop === 0) return '#1a1a1a'

    const rate = (d[metric] || 0) / d.pop * 100000
    const pct = maxVal > minVal ? (rate - minVal) / (maxVal - minVal) : 0

    // Color scale: dark purple -> red -> orange -> yellow
    if (pct < 0.25) {
      const t = pct / 0.25
      return `rgb(${Math.round(60 + t * 80)}, ${Math.round(20 + t * 10)}, ${Math.round(90 - t * 30)})`
    } else if (pct < 0.5) {
      const t = (pct - 0.25) / 0.25
      return `rgb(${Math.round(140 + t * 80)}, ${Math.round(30 + t * 30)}, ${Math.round(60 - t * 30)})`
    } else if (pct < 0.75) {
      const t = (pct - 0.5) / 0.25
      return `rgb(${Math.round(220 + t * 35)}, ${Math.round(60 + t * 80)}, ${Math.round(30 - t * 10)})`
    } else {
      const t = (pct - 0.75) / 0.25
      return `rgb(255, ${Math.round(140 + t * 80)}, ${Math.round(20 + t * 40)})`
    }
  }

  const formatRate = (num) => typeof num === 'number' ? num.toFixed(1) : '0'

  const handleMouseMove = (e) => {
    setMousePos({ x: e.clientX, y: e.clientY })
  }

  return (
    <div style={{ position: 'relative' }} onMouseMove={handleMouseMove}>
      <svg
        viewBox="0 0 960 600"
        style={{ width: '100%', height: 'auto', maxHeight: '500px' }}
      >
        {/* Draw each state */}
        {Object.entries(STATE_PATHS).map(([abbr, state]) => {
          const isHovered = hoveredState === abbr
          const isSelected = selectedState === abbr
          const d = stateDataMap[abbr]

          return (
            <path
              key={abbr}
              d={state.path}
              fill={getColor(abbr)}
              stroke={isSelected ? '#fff' : isHovered ? '#888' : '#333'}
              strokeWidth={isSelected ? 2 : isHovered ? 1.5 : 0.5}
              style={{ cursor: 'pointer', transition: 'fill 0.2s' }}
              onMouseEnter={() => setHoveredState(abbr)}
              onMouseLeave={() => setHoveredState(null)}
              onClick={() => onStateClick && onStateClick(abbr)}
            />
          )
        })}
      </svg>

      {/* Legend */}
      <div style={{
        position: 'absolute',
        bottom: '10px',
        right: '10px',
        background: '#1a1a1a',
        border: '1px solid #333',
        borderRadius: '4px',
        padding: '8px 12px',
        fontSize: '11px'
      }}>
        <div style={{ color: '#888', marginBottom: '4px' }}>Per 100K Pop</div>
        <div style={{ display: 'flex', alignItems: 'center', gap: '4px' }}>
          <div style={{ width: '60px', height: '8px', background: 'linear-gradient(to right, rgb(60,20,90), rgb(140,30,60), rgb(220,60,30), rgb(255,220,60))', borderRadius: '2px' }}></div>
        </div>
        <div style={{ display: 'flex', justifyContent: 'space-between', marginTop: '2px' }}>
          <span style={{ color: '#666' }}>{formatRate(minVal)}</span>
          <span style={{ color: '#666' }}>{formatRate(maxVal)}</span>
        </div>
      </div>

      {/* Tooltip */}
      {hoveredState && stateDataMap[hoveredState] && (
        <div style={{
          position: 'fixed',
          left: mousePos.x + 15,
          top: mousePos.y - 60,
          background: '#1a1a1a',
          border: '1px solid #444',
          borderRadius: '6px',
          padding: '10px 14px',
          zIndex: 1000,
          pointerEvents: 'none',
          minWidth: '140px'
        }}>
          <div style={{ fontSize: '14px', fontWeight: '600', color: '#fff', marginBottom: '6px' }}>
            {STATE_PATHS[hoveredState]?.name}
          </div>
          <div style={{ fontSize: '12px', color: '#888', marginBottom: '4px' }}>
            Pop: {(stateDataMap[hoveredState].pop || 0).toLocaleString()}
          </div>
          <div style={{ fontSize: '13px', color: '#ef4444' }}>
            {metric}: {(stateDataMap[hoveredState][metric] || 0).toLocaleString()}
          </div>
          <div style={{ fontSize: '12px', color: '#888' }}>
            Rate: {formatRate((stateDataMap[hoveredState][metric] || 0) / (stateDataMap[hoveredState].pop || 1) * 100000)}/100K
          </div>
        </div>
      )}
    </div>
  )
}
